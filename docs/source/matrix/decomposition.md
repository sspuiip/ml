# 矩阵分解

## QR分解

### QR的一般形式

对于一般矩阵$\pmb{A}_{m\times n}(m\ge n)$，可以分解为，

$$
\pmb{A}_{m\times n}=\pmb{Q}_{m\times m}\pmb{R}_{m\times n}=\pmb{Q}\left[ \begin{array}{c}\pmb{R}_1\\\pmb{0}\end{array}\right]=\left[ \pmb{Q}_1\quad \pmb{Q}_2\right]\left[ \begin{array}{c}\pmb{R}_1\\\pmb{0}\end{array}\right]=\pmb{Q}_1\pmb{R}_1
$$

其中$\pmb{Q}$为正交矩阵$\pmb{Q}^\top=\pmb{Q}^{-1}$（列向量正交），$\pmb{R}$为上三角矩阵，即$\pmb{R}_1$为$n\times n$的上三角矩阵。一般来说，$\pmb{Q}$矩阵的前$k(1\le k\le n)$个列向量构建了矩阵$\pmb{A}$的前$k$列张成的一个标准正交基。

- **例**1

```matlab
>>>A=[1 2 3;2 4 6;1 1 1]
>>>[Q,R]=qr(A)
>>>Q

   -0.4082   -0.1826   -0.8944
   -0.8165   -0.3651    0.4472
   -0.4082    0.9129   -0.0000
   
>>>R

   -2.4495   -4.4907   -6.5320
         0   -0.9129   -1.8257
         0         0    0.0000
         
>>>Q1=Q(:,1:2)

   -0.4082   -0.1826
   -0.8165   -0.3651
   -0.4082    0.9129
   
>>>R1=R(1:2,:)

   -2.4495   -4.4907   -6.5320
         0   -0.9129   -1.8257
         
>>>Q1*R1

    1.0000    2.0000    3.0000
    2.0000    4.0000    6.0000
    1.0000    1.0000    1.0000
```

- **注意**

当矩阵列不满秩时，可以使用`[Q,R,P]=qr(A)`来分解，且满足$\pmb{A}*\pmb{P}=\pmb{Q}*\pmb{R}$其中$\pmb{P}$为转换矩阵。若$\pmb{A}=[\pmb{x}_1,\pmb{x}_2,...,\pmb{x}_n]$为数据矩阵时，$\pmb{P}$的作用等价于样本重新排列顺序。

```
>>>C=[1 1 2;2 1 4;3 1 6]

     1     1     2
     2     1     4
     3     1     6

>>>[Q,R,P]=qr(C)

Q =
   -0.2673    0.8729    0.4082
   -0.5345    0.2182   -0.8165
   -0.8018   -0.4364    0.4082

R =
   -7.4833   -1.6036   -3.7417
         0    0.6547    0.0000
         0         0    0.0000
         
P =
     0     0     1
     0     1     0
     1     0     0

>>>Q(:,1:rank(R)) * R(1:rank(R),:)
ans =

    2.0000    1.0000    1.0000
    4.0000    1.0000    2.0000
    6.0000    1.0000    3.0000

>>>C*P
ans =

     2     1     1
     4     1     2
     6     1     3
```




### Gram-Schmidt正交求解

