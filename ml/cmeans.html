<!DOCTYPE html>

<html lang="zh-CN" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>1. 聚类(一) &#8212; Machine Learning Fundation 1.0 文档</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/nature.css?v=279e0f84" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <script src="../_static/documentation_options.js?v=f115507d"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script src="../_static/translations.js?v=beaddf03"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="../_static/mathjax/tex-chtml.js"></script>
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜索" href="../search.html" />
    <link rel="next" title="2. BiClustering" href="biClustering.html" />
    <link rel="prev" title="6. 神经网络" href="neuro_network.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="Related">
      <h3>导航</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="总索引"
             accesskey="I">索引</a></li>
        <li class="right" >
          <a href="biClustering.html" title="2. BiClustering"
             accesskey="N">下一页</a> |</li>
        <li class="right" >
          <a href="neuro_network.html" title="6. 神经网络"
             accesskey="P">上一页</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Machine Learning Fundation 1.0 文档</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">1. </span>聚类(一)</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section class="tex2jax_ignore mathjax_ignore" id="id1">
<h1><span class="section-number">1. </span>聚类(一)<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h1>
<section id="kmeans">
<h2><span class="section-number">1.1. </span>KMeans<a class="headerlink" href="#kmeans" title="Link to this heading">¶</a></h2>
<p>  K-Means是一种流行的聚类算法，用于将数据集划分为<span class="math notranslate nohighlight">\(k\)</span>个聚类。它的工作原理是，基于最小化聚类内的方差，不断迭代地细化聚类分配。</p>
<section id="id2">
<h3><span class="section-number">1.1.1. </span><strong>1. 问题定义</strong><a class="headerlink" href="#id2" title="Link to this heading">¶</a></h3>
<p>  给定一个数据集 <span class="math notranslate nohighlight">\( X = \{x_1, x_2, ..., x_N\} \)</span>，其中包含 <span class="math notranslate nohighlight">\( d \)</span> 维空间中的 <span class="math notranslate nohighlight">\( N \)</span> 个数据点，K-Means 的目标是将这些点划分为 <span class="math notranslate nohighlight">\( k \)</span> 个聚类 <span class="math notranslate nohighlight">\( C_1, C_2, ..., C_k \)</span>，其中每个聚类由一个质心 <span class="math notranslate nohighlight">\( \mu_j \)</span> 表示。（Given a dataset <span class="math notranslate nohighlight">\( X = \{x_1, x_2, ..., x_N\} \)</span> with <span class="math notranslate nohighlight">\( N \)</span> data points in <span class="math notranslate nohighlight">\( d \)</span>-dimensional space, the goal of K-Means is to partition these points into <span class="math notranslate nohighlight">\( k \)</span> clusters <span class="math notranslate nohighlight">\( C_1, C_2, ..., C_k \)</span>, where each cluster is represented by a centroid <span class="math notranslate nohighlight">\( \mu_j \)</span>.）</p>
</section>
<section id="id3">
<h3><span class="section-number">1.1.2. </span><strong>2. 目标函数</strong><a class="headerlink" href="#id3" title="Link to this heading">¶</a></h3>
<p>  该算法最小化每个点与其指定的聚类中心之间的平方距离（方差）的总和：</p>
<div class="math notranslate nohighlight" id="equation-kmeans-obj-fun">
<span class="eqno">(1)<a class="headerlink" href="#equation-kmeans-obj-fun" title="Link to this equation">¶</a></span>\[
J = \sum_{i=1}^{N} \sum_{j=1}^{k} \delta_{ij} \| x_i - \mu_j \|^2
\]</div>
<p>其中:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\( \mu_j \)</span> 是聚类<span class="math notranslate nohighlight">\( j \)</span>的中心,</p></li>
<li><p><span class="math notranslate nohighlight">\( \delta_{ij} \)</span> 是一个指示变量，即，如果<span class="math notranslate nohighlight">\( x_i \)</span> 属于聚类<span class="math notranslate nohighlight">\( j \)</span>则为1，否则为0，</p></li>
<li><p><span class="math notranslate nohighlight">\( \| x_i - \mu_j \|^2 \)</span> 为平方欧几里得距离。</p></li>
</ul>
<p>目标函数确保数据点被分配到最近的聚类中心。</p>
</section>
<section id="k-means">
<h3><span class="section-number">1.1.3. </span><strong>3. K-Means 算法步骤</strong><a class="headerlink" href="#k-means" title="Link to this heading">¶</a></h3>
<p><strong>步骤 1：初始化聚类中心</strong></p>
<ul class="simple">
<li><p>从数据集中随机选择 <span class="math notranslate nohighlight">\( k \)</span> 个点作为初始聚类中心 <span class="math notranslate nohighlight">\( \mu_1, \mu_2, ..., \mu_k \)</span>。</p></li>
<li><p>或者，使用**K-Means++**初始化来提高收敛性。</p></li>
</ul>
<p><strong>步骤 2：将数据点分配给最近的聚类</strong></p>
<p>  对于每个数据点 <span class="math notranslate nohighlight">\(x_i\)</span>，将其分配到具有最接近质心的聚类：</p>
<div class="math notranslate nohighlight" id="equation-dist-from-centers">
<span class="eqno">(2)<a class="headerlink" href="#equation-dist-from-centers" title="Link to this equation">¶</a></span>\[
C_j = \{x_i : \| x_i - \mu_j \|^2 \leq \| x_i - \mu_l \|^2, \forall l \neq j \}
\]</div>
<p><strong>步骤 3：更新聚类中心</strong></p>
<p>  将每个聚类的新质心计算为分配给它的所有点的平均值：</p>
<div class="math notranslate nohighlight" id="equation-update-centers">
<span class="eqno">(3)<a class="headerlink" href="#equation-update-centers" title="Link to this equation">¶</a></span>\[
\mu_j = \frac{1}{|C_j|} \sum_{x_i \in C_j} x_i
\]</div>
<p><strong>步骤 4：检查收敛性</strong></p>
<ul class="simple">
<li><p>如果聚类中心没有发生显著变化，则停止。</p></li>
<li><p>否则，重复<strong>步骤 2</strong>和<strong>步骤 3</strong>直到收敛。</p></li>
</ul>
</section>
<section id="id4">
<h3><span class="section-number">1.1.4. </span><strong>4. 收敛性和复杂度</strong><a class="headerlink" href="#id4" title="Link to this heading">¶</a></h3>
<p><strong>收敛性:</strong></p>
<ul class="simple">
<li><p>当聚类分配不再改变或质心稳定时，K-Means 就会收敛。</p></li>
<li><p>它可能会卡在<strong>局部最小值</strong>，因此使用不同的初始化多次运行它会有所帮助。</p></li>
</ul>
<p><strong>时间复杂度:</strong></p>
<ul class="simple">
<li><p>将 <span class="math notranslate nohighlight">\( N \)</span> 个点分配给聚类：<span class="math notranslate nohighlight">\( O(Nk) \)</span></p></li>
<li><p>更新质心：<span class="math notranslate nohighlight">\( O(N) \)</span></p></li>
<li><p>迭代 <span class="math notranslate nohighlight">\( IN \)</span> 次：<span class="math notranslate nohighlight">\( OF(INk) \)</span></p></li>
<li><p><strong>总体复杂度：</strong><span class="math notranslate nohighlight">\( O(I Nk) \)</span></p></li>
</ul>
</section>
<section id="id5">
<h3><span class="section-number">1.1.5. </span><strong>5. K-Means++初始化（更好的初始化）</strong><a class="headerlink" href="#id5" title="Link to this heading">¶</a></h3>
<p>  与随机初始化不同，<strong>K-Means++</strong> 提高了收敛性：</p>
<ol class="arabic simple">
<li><p>从数据中随机选择一个中心。</p></li>
<li><p>选择后续中心，其概率与其与现有最近中心的平方距离成比例（Select subsequent centers with probability proportional to their squared distance from the closest existing center）。</p></li>
<li><p>重复此操作直到选定 <span class="math notranslate nohighlight">\( k \)</span> 个中心。</p></li>
</ol>
<p>  该方法减少了由于初始化不良而导致聚类效果不佳的可能性。</p>
</section>
<hr class="docutils" />
<section id="id6">
<h3><span class="section-number">1.1.6. </span><strong>6. 优点和缺点</strong><a class="headerlink" href="#id6" title="Link to this heading">¶</a></h3>
<p>✅ <strong>优点:</strong></p>
<ul class="simple">
<li><p>简单快速。</p></li>
<li><p>适用于大型数据集。</p></li>
<li><p>当簇呈球形且分离良好时效果良好。</p></li>
</ul>
<p>❌ <strong>缺点:</strong></p>
<ul class="simple">
<li><p>对初始质心敏感。</p></li>
<li><p>可能陷入局部最小值。</p></li>
<li><p>与非球形或重叠簇冲突。</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="python">
<h3><span class="section-number">1.1.7. </span><strong>7.Python实现</strong><a class="headerlink" href="#python" title="Link to this heading">¶</a></h3>
<p>以下是使用 <code class="docutils literal notranslate"><span class="pre">numpy</span></code> 实现的 K-Means 的简单实现：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="k">def</span><span class="w"> </span><span class="nf">initialize_centroids</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">X</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">k</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)]</span>

<span class="k">def</span><span class="w"> </span><span class="nf">assign_clusters</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">centroids</span><span class="p">):</span>
    <span class="n">distances</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span> <span class="o">-</span> <span class="n">centroids</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">distances</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">update_centroids</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">X</span><span class="p">[</span><span class="n">labels</span> <span class="o">==</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">)])</span>

<span class="k">def</span><span class="w"> </span><span class="nf">k_means</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">max_iters</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">):</span>
    <span class="n">centroids</span> <span class="o">=</span> <span class="n">initialize_centroids</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_iters</span><span class="p">):</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="n">assign_clusters</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">centroids</span><span class="p">)</span>
        <span class="n">new_centroids</span> <span class="o">=</span> <span class="n">update_centroids</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">new_centroids</span> <span class="o">-</span> <span class="n">centroids</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">tol</span><span class="p">:</span>
            <span class="k">break</span>
        
        <span class="n">centroids</span> <span class="o">=</span> <span class="n">new_centroids</span>
        
    <span class="k">return</span> <span class="n">centroids</span><span class="p">,</span> <span class="n">labels</span>

<span class="c1"># Example Usage</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="mi">5</span> <span class="o">+</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">centroids</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">k_means</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Final Centroids:&quot;</span><span class="p">,</span> <span class="n">centroids</span><span class="p">)</span>
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="c-fcm">
<h3><span class="section-number">1.1.8. </span><strong>8. 与模糊 C 均值 (FCM) 的比较</strong><a class="headerlink" href="#c-fcm" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>特征</p></th>
<th class="head text-center"><p>K-Means</p></th>
<th class="head text-center"><p>Fuzzy C-Means (FCM)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>成员关系</p></td>
<td class="text-center"><p>Hard (每个点属于一个簇)</p></td>
<td class="text-center"><p>Soft (每个点都有一定程度的属于多个聚类)</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>收敛</p></td>
<td class="text-center"><p>快</p></td>
<td class="text-center"><p>慢</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>簇形状</p></td>
<td class="text-center"><p>适用于球形簇</p></td>
<td class="text-center"><p>适用于复杂的簇形状</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>敏感度</p></td>
<td class="text-center"><p>对初始质心敏感</p></td>
<td class="text-center"><p>更稳健但对参数敏感</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="fuzzy-c-means">
<h2><span class="section-number">1.2. </span>Fuzzy C-Means<a class="headerlink" href="#fuzzy-c-means" title="Link to this heading">¶</a></h2>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../index.html">目录</a></h3>
    <ul>
<li><a class="reference internal" href="#">1. 聚类(一)</a><ul>
<li><a class="reference internal" href="#kmeans">1.1. KMeans</a><ul>
<li><a class="reference internal" href="#id2">1.1.1. <strong>1. 问题定义</strong></a></li>
<li><a class="reference internal" href="#id3">1.1.2. <strong>2. 目标函数</strong></a></li>
<li><a class="reference internal" href="#k-means">1.1.3. <strong>3. K-Means 算法步骤</strong></a></li>
<li><a class="reference internal" href="#id4">1.1.4. <strong>4. 收敛性和复杂度</strong></a></li>
<li><a class="reference internal" href="#id5">1.1.5. <strong>5. K-Means++初始化（更好的初始化）</strong></a></li>
<li><a class="reference internal" href="#id6">1.1.6. <strong>6. 优点和缺点</strong></a></li>
<li><a class="reference internal" href="#python">1.1.7. <strong>7.Python实现</strong></a></li>
<li><a class="reference internal" href="#c-fcm">1.1.8. <strong>8. 与模糊 C 均值 (FCM) 的比较</strong></a></li>
</ul>
</li>
<li><a class="reference internal" href="#fuzzy-c-means">1.2. Fuzzy C-Means</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>上一主题</h4>
    <p class="topless"><a href="neuro_network.html"
                          title="上一章"><span class="section-number">6. </span>神经网络</a></p>
  </div>
  <div>
    <h4>下一主题</h4>
    <p class="topless"><a href="biClustering.html"
                          title="下一章"><span class="section-number">2. </span>BiClustering</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>本页</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/ml/cmeans.md.txt"
            rel="nofollow">显示源代码</a></li>
    </ul>
   </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">快速搜索</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="提交" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="Related">
      <h3>导航</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="总索引"
             >索引</a></li>
        <li class="right" >
          <a href="biClustering.html" title="2. BiClustering"
             >下一页</a> |</li>
        <li class="right" >
          <a href="neuro_network.html" title="6. 神经网络"
             >上一页</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Machine Learning Fundation 1.0 文档</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">1. </span>聚类(一)</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; 版权所有 2022-2024, SSPUIIP.
      由 <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3创建。
    </div>
  </body>
</html>