# 概率图模型

&emsp;&emsp;根据已观察到的数据（样本集）对未知变量（样本所属类别）进行估计，这是从数据学习知识的基本途径，也是机器学习的主要任务。概率模型将这一任务转换为计算变量的概率分布，即利用已知变量推测未知变量，也称之为**推断**。具体来说，假设所关心的变量集为$Y$，可观测变量集为$O$，其它变量为$R$，推断就是通过联合分布$P(Y,R,O)$或条件分布$P(Y,R|O)$计算得到条件分布$P(Y|O)$。其中，联合分布$P(Y,R,O)$称为**生成式模型**，条件分布$P(Y,R|O)$称为**判别式模型**。但是，直接使用概率求和规则消去变量$R$是不可行的，因为即使所有变量只有2种取值的特殊情况，计算复杂度也高达$O(2^{|Y|+|R|})$。

&emsp;&emsp;概率图模型是一种用图来表示变量间关系的概率模型。该图的结点表示一个（组）随机变量，结点之间的边表示变量间的相关关系。根据边的类型不同，图模型又可以继续细分为**有向无环图**（贝叶斯网，Bayesian network）和**无向无环图**（马尔可夫网，Markov network）两种。

## 隐马尔可夫模型

&emsp;&emsp;隐马尔可夫模型（Hidden Markov Model, HMM）是一种有向图模型，主要用于时序数据建模、自然语言处理、语音识别等领域。

```{mermaid}
---
caption: fig 1. Hidden Markov Model
zoom: 80%
align: center
---
block-beta
  columns 10
  x1(("x1")) space x2(("x2")) space x3(("x3")) space x4(("...")) space x5(("xn")) space space space space space space space space space space space
  y1(("y1")) space y2(("y2")) space y3(("y3")) space y4(("...")) space y5(("yn"))
  y1 --> y2
  y2 --> y3
  y3 --> y4
  y4 --> y5
  y1 --> x1
  y2 --> x2
  y3 --> x3
  y4 --> x4
  y5 --> x5
```
&emsp;&emsp;如上图所示，隐马尔可夫模型中的变量分为两类，第一类为状态变量$\{y_1,y_2,...,y_n\}$，$y_i$表示第$i$时刻的系统状态，一般状态变量是不可观测的，也称为隐变量；第二类为观测变量$\{x_1,x_2,...,x_n\}$，$x_i$表示为第$i$时刻的观测值。图中的箭头代表的是变量间的依赖关系。具体来说有以下两点：

- $x_t$只依赖$y_t$。$t$时刻的观测值只与$t$时刻的状态相关，与其它状态无关。

- $y_t$只依赖$y_{t-1}$。 该性质也就是所谓的**马尔可夫性**。

根据依赖关系，HMM所有变量的联合分布为，

$$
P(x_1,...,x_n,y_1,...,y_n)=P(y_1)P(x_1|y_1)\prod_{i=2}^n P(x_i|y_i)P(y_{i}|y_{i-1})
$$